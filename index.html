<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="description" content="Ronin Logger - Track your Japanese immersion hours">
  <title>æµªäºº Logger</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="manifest" href="manifest.json">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+JP:wght@700&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="app">
    <!-- Header with Power Level & Streak -->
    <header class="header">
      <div class="power-level">
        <span class="power-label">POWER</span>
        <span class="power-value" id="powerLevel">Lvl 0</span>
      </div>
      <div class="streak-display">
        <span class="streak-fire">ðŸ”¥</span>
        <span class="streak-count" id="streakCount">0</span>
        <span class="streak-label">day streak</span>
      </div>
      <button class="settings-btn" id="settingsBtn" aria-label="Settings">âš™</button>
    </header>

    <!-- Weekly Ring -->
    <section class="ring-section">
      <div class="ring-container">
        <svg class="progress-ring" viewBox="0 0 200 200">
          <defs>
            <linearGradient id="ringGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#3b82f6" />
              <stop offset="100%" stop-color="#06b6d4" />
            </linearGradient>
            <linearGradient id="goldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" stop-color="#fbbf24" />
              <stop offset="100%" stop-color="#f59e0b" />
            </linearGradient>
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="coloredBlur" />
              <feMerge>
                <feMergeNode in="coloredBlur" />
                <feMergeNode in="SourceGraphic" />
              </feMerge>
            </filter>
          </defs>
          <circle class="ring-bg" cx="100" cy="100" r="85" />
          <circle class="ring-progress" id="ringProgress" cx="100" cy="100" r="85" />
        </svg>
        <div class="ring-inner">
          <div class="week-hours" id="weekHours">0h</div>
          <div class="week-label">/ 21h this week</div>
        </div>
      </div>
      <div class="week-status" id="weekStatus">Week 52 â€¢ Resets Sunday</div>
    </section>

    <!-- Mountain (Total Progress) -->
    <section class="mountain-section">
      <div class="mountain-header">
        <span class="mountain-label">THE MOUNTAIN</span>
        <span class="mountain-value" id="totalHours">0h / 3,000h</span>
      </div>
      <div class="mountain-bar">
        <div class="mountain-progress" id="mountainProgress"></div>
      </div>
      <div class="rank-display" id="rankDisplay">Rank F â€¢ Beginner</div>
    </section>

    <section class="input-section">
      <div class="preset-row">
        <button class="preset-btn" data-mins="24">24m<span class="preset-hint">anime</span></button>
        <button class="preset-btn" data-mins="24">24m<span class="preset-hint">manga</span></button>
        <button class="preset-btn" data-mins="45">45m<span class="preset-hint">podcast</span></button>
        <button class="preset-btn" data-mins="60">60m<span class="preset-hint">1 hour</span></button>
      </div>
      <div class="input-wrapper">
        <input type="number" id="minutesInput" class="minutes-input" placeholder="24" inputmode="numeric" min="1"
          max="999">
        <span class="input-suffix">mins</span>
      </div>
      <button class="claim-btn" id="claimBtn">
        <span class="claim-text">CLAIM</span>
        <span class="claim-icon">âš¡</span>
      </button>
    </section>

    <!-- Recent Log -->
    <section class="log-section" id="logSection">
      <div class="log-header">Recent Claims</div>
      <div class="log-list" id="logList"></div>
    </section>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal">
      <div class="modal-header">
        <h2>Settings</h2>
        <button class="modal-close" id="closeSettings">Ã—</button>
      </div>
      <div class="modal-body">
        <div class="setting-group">
          <label for="weeklyGoal">Weekly Goal (hours)</label>
          <input type="number" id="weeklyGoal" value="21" min="1" max="100">
        </div>
        <div class="setting-group">
          <label for="totalGoal">Mountain Goal (hours)</label>
          <input type="number" id="totalGoal" value="3000" min="100" max="10000">
        </div>
        <div class="setting-group">
          <label for="ankiWords">Anki Mature Cards (Power Level)</label>
          <input type="number" id="ankiWords" value="0" min="0">
        </div>
        <hr>
        <div class="setting-group">
          <label for="manualTotal">Manual Total Hours Adjustment</label>
          <input type="number" id="manualTotal" placeholder="Current total" min="0">
          <button class="save-manual-btn" id="saveManualTotal">Set Total</button>
        </div>
        <hr>
        <div class="setting-group">
          <label>Quick Presets (minutes)</label>
          <div class="presets-editor">
            <div class="preset-edit"><input type="number" id="preset1" value="24" min="1" max="999"
                class="preset-input"><span>anime</span></div>
            <div class="preset-edit"><input type="number" id="preset2" value="24" min="1" max="999"
                class="preset-input"><span>manga</span></div>
            <div class="preset-edit"><input type="number" id="preset3" value="45" min="1" max="999"
                class="preset-input"><span>podcast</span></div>
            <div class="preset-edit"><input type="number" id="preset4" value="60" min="1" max="999"
                class="preset-input"><span>hour</span></div>
          </div>
        </div>
        <hr>
        <div class="setting-group">
          <label>AnkiConnect (auto-sync)</label>
          <div class="anki-connect-row">
            <input type="text" id="ankiDeck" placeholder="Deck name (e.g. Mining)" class="anki-input">
            <button class="sync-anki-btn" id="syncAnkiBtn">Sync</button>
          </div>
          <small class="anki-hint">Requires AnkiConnect add-on running on port 8765</small>
        </div>
        <hr>
        <div class="setting-group">
          <label>Account (Cloud Sync)</label>
          <div id="authSection">
            <div id="authLoggedOut">
              <input type="email" id="authEmail" placeholder="Email" class="cloud-input">
              <input type="password" id="authPassword" placeholder="Password" class="cloud-input"
                style="margin-top:8px">
              <div class="auth-buttons">
                <button class="cloud-sync-btn" id="loginBtn">Login</button>
                <button class="cloud-sync-btn" id="signupBtn">Sign Up</button>
              </div>
            </div>
            <div id="authLoggedIn" style="display:none">
              <div class="auth-user">Logged in as: <strong id="authUserEmail">-</strong></div>
              <button class="cloud-sync-btn" id="logoutBtn" style="margin-top:8px">Logout</button>
            </div>
          </div>
          <small class="anki-hint" id="authStatus">Login to sync across devices</small>
        </div>
      </div>
      <div class="modal-footer">
        <button class="export-btn" id="exportBtn">Export Data</button>
        <button class="import-btn" id="importBtn">Import Data</button>
        <input type="file" id="importFile" accept=".json" style="display:none">
      </div>
    </div>
  </div>

  <audio id="claimSound" preload="auto">
    <source src="assets/claim.mp3" type="audio/mpeg">
  </audio>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <script src="app.js"></script>
</body>

</html>